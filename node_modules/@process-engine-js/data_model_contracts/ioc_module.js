'use strict';

const PropertyBag = require('./dist/commonjs/index').PropertyBag;
const EncryptionService = require('./dist/commonjs/index').EncryptionService;
const EntityDependencyHelper = require('./dist/commonjs/index').EntityDependencyHelper;

function registerInContainer(container, useCustomEncryptionService) {

  container.register('PropertyBag', PropertyBag)
    .dependencies('DatastoreService', 'MetadataProvider', 'IamService')
    .injectLazy('DatastoreService');

  if (!useCustomEncryptionService) {
    container.register('EncryptionService', EncryptionService)
      .configure('data_model:encryption_service')
      .singleton();
  }

  container.register('EntityDependencyHelper', EntityDependencyHelper)
    .dependencies('DatastoreService', 'PropertyBag', 'EncryptionService', 'Invoker')
    .injectLazy('DatastoreService', 'PropertyBag');
}

module.exports.registerInContainer = registerInContainer;
